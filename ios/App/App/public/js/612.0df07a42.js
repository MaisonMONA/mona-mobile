"use strict";(self["webpackChunkmona"]=self["webpackChunkmona"]||[]).push([[612],{6612:(e,n,o)=>{o.r(n),o.d(n,{default:()=>P});o(3948);var t=o(6252);const r=e=>((0,t.dD)("data-v-1a68bb24"),e=e(),(0,t.Cn)(),e),s=r((()=>(0,t._)("p",{id:"register-alert-holder"},null,-1))),i={class:"main-content"},a=r((()=>(0,t._)("p",{id:"welcome"},"Inscription",-1))),l=r((()=>(0,t._)("p",{id:"ask-for-registration"},[(0,t.Uk)("Bienvenue !"),(0,t._)("br"),(0,t.Uk)("Commençons par créer un compte.")],-1))),u={class:"form-section"},p={class:"input-element username"},c=r((()=>(0,t._)("label",{for:"username-input"},"Nom d'utilisateur",-1))),d={class:"input-element email"},m=r((()=>(0,t._)("label",{for:"email"},"Adresse courriel (optionnel)",-1))),w={class:"input-element password"},h=r((()=>(0,t._)("label",{for:"password-input"},"Mot de passe",-1))),f={class:"input-element password-confirmation"},_=r((()=>(0,t._)("label",{for:"password-confirmation-input"},"Vérifiez le mot de passe",-1))),g=r((()=>(0,t._)("span",null,"Se connecter",-1)));function k(e,n,o,r,k,b){const v=(0,t.up)("ion-title"),I=(0,t.up)("ion-toolbar"),W=(0,t.up)("ion-header"),y=(0,t.up)("ion-input"),S=(0,t.up)("ion-item"),T=(0,t.up)("ion-button"),A=(0,t.up)("ion-content"),C=(0,t.up)("ion-page");return(0,t.wg)(),(0,t.j4)(C,null,{default:(0,t.w5)((()=>[(0,t.Wm)(W,null,{default:(0,t.w5)((()=>[(0,t.Wm)(I,null,{default:(0,t.w5)((()=>[(0,t.Wm)(v,null,{default:(0,t.w5)((()=>[(0,t.Uk)("MONA")])),_:1})])),_:1})])),_:1}),(0,t.Wm)(A,{fullscreen:!0},{default:(0,t.w5)((()=>[s,(0,t._)("div",i,[a,l,(0,t._)("div",u,[(0,t._)("div",p,[c,(0,t.Wm)(S,{id:"username-input"},{default:(0,t.w5)((()=>[(0,t.Wm)(y)])),_:1})]),(0,t._)("div",d,[m,(0,t.Wm)(S,{id:"email-input"},{default:(0,t.w5)((()=>[(0,t.Wm)(y)])),_:1})]),(0,t._)("div",w,[h,(0,t.Wm)(S,{id:"password-input"},{default:(0,t.w5)((()=>[(0,t.Wm)(y,{type:"password"})])),_:1})]),(0,t._)("div",f,[_,(0,t.Wm)(S,{id:"password-confirmation-input"},{default:(0,t.w5)((()=>[(0,t.Wm)(y,{type:"password"})])),_:1})]),(0,t.Wm)(T,{onClick:b.register},{default:(0,t.w5)((()=>[(0,t.Uk)("S'inscrire")])),_:1},8,["onClick"]),(0,t._)("p",{class:"redirect-to-login",onClick:n[0]||(n[0]=(...e)=>b.goToLogin&&b.goToLogin(...e))},[(0,t.Uk)("Déjà un compte ? "),g])])])])),_:1})])),_:1})}o(4916),o(5306),o(7658);var b=o(7285),v=o(2033),I=o(5951),W=o(891),y=o(6826),S=o(411);const T={name:"RegisterPage",components:{IonPage:b._i,IonHeader:b.Gu,IonToolbar:b.sr,IonTitle:b.wd,IonContent:b.W2,IonItem:b.Ie,IonInput:b.pK,IonButton:b.YG},async beforeMount(){await v.m.populate(),v.m.hasSeenTutorial()?""!==v.m.getToken()?this.$router.replace("/loading"):await this.checkPermissions():this.$router.replace("/tutorial")},methods:{goToLogin(){this.$router.push("/login")},register(){const e=document.querySelector("ion-item#username-input ion-input").value,n=document.querySelector("ion-item#email-input ion-input").value,o=document.querySelector("ion-item#password-input ion-input").value,t=document.querySelector("ion-item#password-confirmation-input ion-input").value;if(e&&o&&t)if(o===t){const r=new FormData;r.append("username",e.trim()),r.append("password",t),r.append("password_confirmation",o),n&&r.append("email",n),fetch(I.Z.apiRoutes.register,{method:"POST",body:r}).then((async n=>{const o=await n.json();n.ok?(o.token||this.showAlert("Server error"),v.m.setToken(o.token),v.m.setUsername(e.trim()),this.$router.replace("/loading")):this.handleError(o)})).catch((()=>{this.showAlert("Impossible de se connecter à internet !")}))}else this.showAlert("Les mots de passe ne concordent pas.")},handleError(e){e.errors&&(e.errors.username?this.showAlert(e.errors.username[0]):e.errors.password?this.showAlert(e.errors.password[0]):e.errors.email&&this.showAlert(e.errors.email[0]))},showAlert(e){const n=document.getElementById("register-alert-holder");n.innerHTML=e,n.classList.add("show")},async checkPermissions(){const e=await y.V1.checkPermissions(),n=await W.fy.checkPermissions(),o=await S.b.checkPermissions();"granted"===e.camera&&"granted"===n.publicStorage&&"granted"===o.location||this.$router.replace("/permission-denied")}}};var A=o(3744);const C=(0,A.Z)(T,[["render",k],["__scopeId","data-v-1a68bb24"]]),P=C}}]);
//# sourceMappingURL=612.0df07a42.js.map