{"version":3,"file":"js/190.9724f61a.js","mappings":"mNASYA,EAAAA,EAAAA,GAAwB,KAArBC,GAAG,eAAa,W,UACnBD,EAAAA,EAAAA,GAA+C,mBAA5C,2BAAsBA,EAAAA,EAAAA,GAAI,mCAAc,K,4KATnDE,EAAAA,EAAAA,IAYWC,EAAA,M,kBAXP,IAIa,EAJbC,EAAAA,EAAAA,IAIaC,EAAA,M,kBAHT,IAEc,EAFdD,EAAAA,EAAAA,IAEcE,EAAA,M,kBADV,IAA2B,EAA3BF,EAAAA,EAAAA,IAA2BG,EAAA,M,kBAAhB,IAAI,UAAJ,W,yBAInBH,EAAAA,EAAAA,IAGcI,EAAA,CAHAC,YAAY,GAAI,C,kBAC1B,IAAwB,CAAxBC,EACAC,K,yHCNN,MAAOC,UAAsBC,EAAAA,EAKrBC,2BAA2BC,GACjC,OAAO,IAAIC,EAAAA,GAAMD,EACrB,CAEOD,iBAAiBb,GACpB,OAAOgB,MAAMC,UAAUjB,EAC3B,G,OAXSW,EAAc,OACU,KAAEO,EAAAA,EAAAA,GAD1BP,EAAc,OAEC,wBAAqBO,EAAAA,EAAAA,GAFpCP,EAAc,OAGC,U,cDkB5B,SACIQ,KAAM,kBACNC,WAAY,CACRC,QAAO,KAAEC,UAAS,KAAEC,WAAU,KAAEC,SAAQ,KAAEC,WAAUA,EAAAA,IAGxDC,UAEIC,QAAQC,IAAI,CACRC,EAAAA,EAAgBC,WAChBC,EAAAA,EAAcD,WACdE,EAAAA,EAAiBF,WACjBnB,EAAcmB,aAEjBG,OAAM,KACHC,KAAKC,UAAU,0CAA0C,IAE5DC,MAAK,IAAMT,QAAQC,IAAI,CAChBS,EAAAA,EAASC,gBACTD,EAAAA,EAASE,gBAGhBH,MAAK,KAEFC,EAAAA,EAASG,mBACTH,EAAAA,EAASI,gCAAgC,IAE5CL,MAAK,IAAMF,KAAKQ,QAAQC,QAAQ,eAChCV,OAAOW,IACJ,MAAM,IAAIC,MAAO,iCAAgCD,KAAO,GAEhE,EAEAE,QAAS,CACLX,UAAUY,GACN,MAAMC,EAAYC,SAASC,eAAe,eAE1CF,EAAUG,UAAYJ,EACtBC,EAAUI,UAAUC,IAAI,OAC5B,I,cEzDR,MAAMC,GAA2B,OAAgB,EAAQ,CAAC,CAAC,SAASC,GAAQ,CAAC,YAAY,qBAEzF,G","sources":["webpack://mona/./src/views/DataLoadingPage.vue","webpack://mona/./src/internal/databases/BadgeDatabase.ts","webpack://mona/./src/views/DataLoadingPage.vue?cd14"],"sourcesContent":["<template>\n    <ion-page>\n        <ion-header>\n            <ion-toolbar>\n                <ion-title>MONA</ion-title>\n            </ion-toolbar>\n        </ion-header>\n\n        <ion-content :fullscreen=\"true\">\n            <p id=\"alertHolder\"></p>\n            <p>Chargement des données<br>utilisateur...</p>\n        </ion-content>\n\n    </ion-page>\n</template>\n\n<script>\nimport { IonPage, IonHeader, IonToolbar, IonTitle, IonContent } from \"@ionic/vue\";\nimport { ArtworkDatabase } from \"@/internal/databases/ArtworkDatabase\";\nimport { PlaceDatabase } from \"@/internal/databases/PlaceDatabase\";\nimport { HeritageDatabase } from \"@/internal/databases/HeritageDatabase\";\nimport { BadgeDatabase } from \"@/internal/databases/BadgeDatabase\";\nimport { UserData } from \"@/internal/databases/UserData\";\n\n\nexport default {\n    name: \"DataLoadingPage\",\n    components: {\n        IonPage, IonHeader, IonToolbar, IonTitle, IonContent\n    },\n\n    mounted() {\n        /* Initializing all databases */\n        Promise.all([\n            ArtworkDatabase.populate(),\n            PlaceDatabase.populate(),\n            HeritageDatabase.populate(),\n            BadgeDatabase.populate(),\n        ])\n        .catch(() => {\n            this.showAlert(\"Impossible de se connecter à internet !\")\n        })\n        .then(() => Promise.all([\n                UserData.getFromServer(),\n                UserData.loadCache()\n            ])\n        )\n        .then(() => {\n            // async functions, but DO NOT await (background tasks)\n            UserData.checkForDBUpdate();\n            UserData.tryUploadingPendingDiscoveries();\n        })\n        .then(() => this.$router.replace(\"/tabs/map\"))\n        .catch((err) => {\n            throw new Error(`Could not retrieve user data (${err})`)\n        })\n    },\n\n    methods: {\n        showAlert(alertMessage) {\n            const alertElem = document.getElementById(\"alertHolder\");\n\n            alertElem.innerHTML = alertMessage;\n            alertElem.classList.add(\"show\");\n        }\n    }\n}\n</script>\n\n<style scoped>\n@import url(\"@/theme/GlobalStyle.css\");\n\np {\n    position: relative;\n    font-family: 'Gotham Rounded Light', sans-serif;\n    text-align: center;\n    top: 35%;\n}\n\n.ion-page {\n    background: white;\n}\n\n#alertHolder {\n    position: absolute;\n    text-align: center;\n    transform: translateX(-50%);\n    left: 50%;\n\n    top: 20%;\n\n    margin: 15% 0 0;\n    padding: 0.2em 0.4em;\n    border-radius: 4px;\n\n    font-weight: bolder;\n    color: white;\n    background: white;\n    font-size: 12px;\n\n    transition: all 0.3s linear;\n}\n\n#alertHolder.show {\n    color: darkred;\n    background: #E6B1B1;\n}\n</style>\n","import { Badge } from \"@/internal/Types\"\nimport { Database } from \"@/internal/databases/Database\";\n\n\nexport class BadgeDatabase extends Database {\n    protected static data: Badge[] = [];\n    protected static path = \"appdata/badges.json\";\n    protected static type = \"badges\"\n\n    protected static createSingleElement(badge: any) {\n        return new Badge(badge);\n    }\n\n    public static getFromId(id: number): Badge | null {\n        return super.getFromId(id) as Badge | null;\n    }\n}\n","import { render } from \"./DataLoadingPage.vue?vue&type=template&id=16253808&scoped=true\"\nimport script from \"./DataLoadingPage.vue?vue&type=script&lang=js\"\nexport * from \"./DataLoadingPage.vue?vue&type=script&lang=js\"\n\nimport \"./DataLoadingPage.vue?vue&type=style&index=0&id=16253808&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-16253808\"]])\n\nexport default __exports__"],"names":["_createElementVNode","id","_createBlock","_component_ion_page","_createVNode","_component_ion_header","_component_ion_toolbar","_component_ion_title","_component_ion_content","fullscreen","_hoisted_1","_hoisted_2","BadgeDatabase","Database","static","badge","Badge","super","getFromId","_defineProperty","name","components","IonPage","IonHeader","IonToolbar","IonTitle","IonContent","mounted","Promise","all","ArtworkDatabase","populate","PlaceDatabase","HeritageDatabase","catch","this","showAlert","then","UserData","getFromServer","loadCache","checkForDBUpdate","tryUploadingPendingDiscoveries","$router","replace","err","Error","methods","alertMessage","alertElem","document","getElementById","innerHTML","classList","add","__exports__","render"],"sourceRoot":""}