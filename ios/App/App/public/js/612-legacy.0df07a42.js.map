{"version":3,"file":"js/612-legacy.0df07a42.js","mappings":"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","sources":["webpack://mona/./src/views/RegisterPage.vue","webpack://mona/./src/views/RegisterPage.vue?5906"],"sourcesContent":["<template>\n    <ion-page>\n\n        <ion-header>\n            <ion-toolbar>\n                <ion-title>MONA</ion-title>\n            </ion-toolbar>\n        </ion-header>\n\n        <ion-content :fullscreen=\"true\">\n            <p id=\"register-alert-holder\"></p>\n            <div class=\"main-content\">\n                <p id=\"welcome\">Inscription</p>\n                <p id=\"ask-for-registration\">Bienvenue !<br>Commençons par créer un compte.</p>\n\n                <div class=\"form-section\">\n                    <div class=\"input-element username\">\n                        <label for=\"username-input\">Nom d'utilisateur</label>\n                        <ion-item id=\"username-input\">\n                            <ion-input></ion-input>\n                        </ion-item>\n                    </div>\n\n                    <div class=\"input-element email\">\n                        <label for=\"email\">Adresse courriel (optionnel)</label>\n                        <ion-item id=\"email-input\">\n                            <ion-input></ion-input>\n                        </ion-item>\n                    </div>\n\n                    <div class=\"input-element password\">\n                        <label for=\"password-input\">Mot de passe</label>\n                        <ion-item id=\"password-input\">\n                            <ion-input type=\"password\"></ion-input>\n                        </ion-item>\n                    </div>\n\n                    <div class=\"input-element password-confirmation\">\n                        <label for=\"password-confirmation-input\">Vérifiez le mot de passe</label>\n                        <ion-item id=\"password-confirmation-input\">\n                            <ion-input type=\"password\"></ion-input>\n                        </ion-item>\n                    </div>\n\n                    <ion-button @click=\"register\">S'inscrire</ion-button>\n\n                    <p class=\"redirect-to-login\" @click=\"goToLogin\">Déjà un compte ? <span>Se connecter</span></p>\n                </div>\n            </div>\n        </ion-content>\n\n    </ion-page>\n</template>\n\n<script>\nimport { IonPage, IonHeader, IonToolbar, IonTitle, IonContent, IonItem, IonInput, IonButton } from \"@ionic/vue\";\nimport { UserData } from \"@/internal/databases/UserData\";\nimport Globals from \"@/internal/Globals\";\nimport { Filesystem } from \"@capacitor/filesystem\";\nimport { Camera } from \"@capacitor/camera\";\nimport { Geolocation } from \"@capacitor/geolocation\";\n\n\nexport default {\n    name: \"RegisterPage\",\n    components: {\n        IonPage, IonHeader, IonToolbar, IonTitle, IonContent, IonItem, IonInput, IonButton\n    },\n\n    async beforeMount() {\n        await UserData.populate();\n\n        if (!UserData.hasSeenTutorial()) {\n            // Show tutorial on first time\n            this.$router.replace(\"/tutorial\");\n        } else if (UserData.getToken() !== '') {\n            // If user is logged in, redirect immediately\n            this.$router.replace(\"/loading\");\n        } else {\n            await this.checkPermissions();\n        }\n    },\n\n    methods: {\n        goToLogin() {\n            this.$router.push(\"/login\");\n        },\n\n        register() {\n            const username = document.querySelector(\"ion-item#username-input ion-input\").value;\n            const email = document.querySelector(\"ion-item#email-input ion-input\").value;\n            const password = document.querySelector(\"ion-item#password-input ion-input\").value;\n            const passwordConfirm = document.querySelector(\"ion-item#password-confirmation-input ion-input\").value;\n\n            if (username && password && passwordConfirm) {\n                if (password === passwordConfirm) {\n                    const formData = new FormData();\n                    formData.append(\"username\", username.trim());\n                    formData.append(\"password\", passwordConfirm);\n                    formData.append(\"password_confirmation\", password);\n\n                    if (email) {\n                        formData.append(\"email\", email);\n                    }\n\n                    fetch(Globals.apiRoutes.register, {\n                        method: \"POST\",\n                        body: formData\n                    })\n\n                    .then(async (response) => {\n                        const parsed = await response.json();\n\n                        if (response.ok) {\n                            if (!parsed.token) {\n                                this.showAlert(\"Server error\");\n                            }\n\n                            UserData.setToken(parsed.token);\n                            UserData.setUsername(username.trim());\n                            this.$router.replace(\"/loading\");\n                        } else {\n                            // Show appropriate error\n                            this.handleError(parsed);\n                        }\n                    })\n\n                    .catch(() => {\n                        this.showAlert(\"Impossible de se connecter à internet !\");\n                    });\n                } else {\n                    // Password mismatch\n                    this.showAlert(\"Les mots de passe ne concordent pas.\")\n                }\n            }\n        },\n\n        handleError(parsed) {\n            if (parsed.errors) {\n                if (parsed.errors.username) this.showAlert(parsed.errors.username[0]);\n                else if (parsed.errors.password) this.showAlert(parsed.errors.password[0])\n                else if (parsed.errors.email) this.showAlert(parsed.errors.email[0]);\n            }\n        },\n\n        showAlert(alertMessage) {\n            const alertElem = document.getElementById(\"register-alert-holder\");\n\n            alertElem.innerHTML = alertMessage;\n            alertElem.classList.add(\"show\");\n        },\n\n        async checkPermissions() {\n            const cameraPermStatus   = await Camera.checkPermissions();\n            const filePermStatus     = await Filesystem.checkPermissions();\n            const locationPermStatus = await  Geolocation.checkPermissions();\n\n            if (cameraPermStatus.camera !== \"granted\" ||\n                filePermStatus.publicStorage !== \"granted\" ||\n                locationPermStatus.location !== \"granted\") {\n\n                this.$router.replace(\"/permission-denied\");\n            }\n        }\n    }\n}\n</script>\n\n<style scoped>\n@import url(\"@/theme/TopToolbar.css\");\n\n.ion-page {\n    background: white;\n}\n\np, label {\n    font-family: 'Gotham Rounded Light', sans-serif;\n}\n\n#welcome {\n    font-size: 20px;\n    font-weight: bold;\n}\n\n.main-content {\n    font-size: 14px;\n    text-align: center;\n    position: relative;\n    top: 5%;\n    width: 100%;\n    height: 85%;\n}\n\ndiv.form-section {\n    position: relative;\n    width: 100%;\n    height: 80%;\n}\n\n.input-element {\n    width: 70%;\n    margin: 5% auto;\n}\n\n.input-element * {\n    text-align: center;\n}\n\nion-input {\n    font-size: 14px;\n}\n\nlabel {\n    display: block;\n    text-align: center;\n}\n\n.redirect-to-login span {\n    font-weight: bolder;\n    border-bottom: 1px solid black;\n}\n\n#register-alert-holder {\n    position: absolute;\n    text-align: center;\n    transform: translateX(-50%);\n    left: 50%;\n\n    margin: 5% 0 0;\n    padding: 0.2em 0.4em;\n    border-radius: 4px;\n\n    font-weight: bolder;\n    color: white;\n    background: white;\n    font-size: 12px;\n\n    transition: all 0.3s linear;\n}\n\n#register-alert-holder.show {\n    color: darkred;\n    background: #E6B1B1;\n}\n</style>\n","import { render } from \"./RegisterPage.vue?vue&type=template&id=1a68bb24&scoped=true\"\nimport script from \"./RegisterPage.vue?vue&type=script&lang=js\"\nexport * from \"./RegisterPage.vue?vue&type=script&lang=js\"\n\nimport \"./RegisterPage.vue?vue&type=style&index=0&id=1a68bb24&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-1a68bb24\"]])\n\nexport default __exports__"],"names":["_createElementVNode","id","class","for","_createBlock","_component_ion_page","_createVNode","_component_ion_header","_component_ion_toolbar","_component_ion_title","_component_ion_content","fullscreen","_hoisted_1","_hoisted_2","_hoisted_3","_hoisted_4","_hoisted_5","_hoisted_6","_hoisted_7","_component_ion_item","_component_ion_input","_hoisted_8","_hoisted_9","_hoisted_10","_hoisted_11","type","_hoisted_12","_hoisted_13","_component_ion_button","onClick","$options","register","_cache","args","goToLogin","_hoisted_14","name","components","IonPage","IonHeader","IonToolbar","IonTitle","IonContent","IonItem","IonInput","IonButton","async","UserData","populate","hasSeenTutorial","getToken","this","$router","replace","checkPermissions","methods","push","username","document","querySelector","value","email","password","passwordConfirm","formData","FormData","append","trim","fetch","Globals","apiRoutes","method","body","then","parsed","response","json","ok","token","showAlert","setToken","setUsername","handleError","catch","errors","alertMessage","alertElem","getElementById","innerHTML","classList","add","cameraPermStatus","Camera","filePermStatus","Filesystem","locationPermStatus","Geolocation","camera","publicStorage","location","__exports__","render"],"sourceRoot":""}