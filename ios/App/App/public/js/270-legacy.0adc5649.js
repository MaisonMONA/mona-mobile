"use strict";(self["webpackChunkmona"]=self["webpackChunkmona"]||[]).push([[270],{7228:(e,t,n)=>{n.r(t),n.d(t,{default:()=>F});var o=n(6252);function i(e,t,n,i,a,s){const r=(0,o.up)("ion-title"),c=(0,o.up)("ion-toolbar"),l=(0,o.up)("ion-header"),u=(0,o.up)("MapContainer"),p=(0,o.up)("ion-content"),m=(0,o.up)("ion-page");return(0,o.wg)(),(0,o.j4)(m,null,{default:(0,o.w5)((()=>[(0,o.Wm)(l,null,{default:(0,o.w5)((()=>[(0,o.Wm)(c,null,{default:(0,o.w5)((()=>[(0,o.Wm)(r,null,{default:(0,o.w5)((()=>[(0,o.Uk)("MONA")])),_:1})])),_:1})])),_:1}),(0,o.Wm)(p,{fullscreen:!0},{default:(0,o.w5)((()=>[(0,o.Wm)(u)])),_:1})])),_:1})}var a=n(7285);const s=e=>((0,o.dD)("data-v-483f4aac"),e=e(),(0,o.Cn)(),e),r={id:"map",class:"map"},c={id:"popup"},l={id:"popup-content",hidden:""},u=s((()=>(0,o._)("div",{id:"popup-details"},[(0,o._)("p",{id:"popupTitle",class:"details"}),(0,o._)("p",{id:"popupSubtext",class:"details"})],-1)));function p(e,t,n,i,a,s){const p=(0,o.up)("ion-icon"),m=(0,o.up)("ion-button");return(0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o._)("div",r,[(0,o._)("div",c,[(0,o._)("div",l,[u,(0,o.Wm)(m,{fill:"clear",id:"seeMore","router-direction":"forward"},{default:(0,o.w5)((()=>[(0,o.Wm)(p,{slot:"icon-only",icon:a.arrowRightIcon},null,8,["icon"])])),_:1})])])]),(0,o.Wm)(m,{onClick:s.changeTileLayer,id:"settings-button",class:"map-button"},{default:(0,o.w5)((()=>[(0,o.Wm)(p,{icon:a.settingsIcon},null,8,["icon"])])),_:1},8,["onClick"]),(0,o.Wm)(m,{onClick:s.recenterView,id:"recenter-button",class:"map-button"},{default:(0,o.w5)((()=>[(0,o.Wm)(p,{icon:a.locationIcon},null,8,["icon"])])),_:1},8,["onClick"])],64)}n(3948),n(7658);var m=n(8903),d=n(5699),h=n(2241),g=n(1162),y=n(8734),A=n(6835),w=n(188),Z=n(1090),f=n(8266),I=n(1826);const v=['Map tiles by <a href="https://stamen.com/" target="_blank">Stamen Design</a>, under <a href="https://creativecommons.org/licenses/by/3.0/" target="_blank">CC BY 3.0</a>.',f.h],L={terrain:{extension:"png",opaque:!0},"terrain-background":{extension:"png",opaque:!0},"terrain-labels":{extension:"png",opaque:!1},"terrain-lines":{extension:"png",opaque:!1},"toner-background":{extension:"png",opaque:!0},toner:{extension:"png",opaque:!0},"toner-hybrid":{extension:"png",opaque:!1},"toner-labels":{extension:"png",opaque:!1},"toner-lines":{extension:"png",opaque:!1},"toner-lite":{extension:"png",opaque:!0},watercolor:{extension:"jpg",opaque:!0}},x={terrain:{minZoom:0,maxZoom:18},toner:{minZoom:0,maxZoom:20},watercolor:{minZoom:0,maxZoom:18}};class b extends I.Z{constructor(e){const t=e.layer.indexOf("-"),n=-1==t?e.layer:e.layer.slice(0,t),o=x[n],i=L[e.layer],a=void 0!==e.url?e.url:"https://stamen-tiles-{a-d}.a.ssl.fastly.net/"+e.layer+"/{z}/{x}/{y}."+i.extension;super({attributions:v,cacheSize:e.cacheSize,crossOrigin:"anonymous",interpolate:e.interpolate,maxZoom:void 0!=e.maxZoom?e.maxZoom:o.maxZoom,minZoom:void 0!=e.minZoom?e.minZoom:o.minZoom,opaque:i.opaque,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileLoadFunction:e.tileLoadFunction,transition:e.transition,url:a,wrapX:e.wrapX,zDirection:e.zDirection})}}const M=b;var E=n(9427),T=n(7166),C=n(3376),q=n(1015),B=n(2033),D=n(7282),G=n(2201),k=n(7539),O=n(1332);const z=n.p+"img/location.70fcd012.svg";let S=!1;function W(e,t){for(const n of t){const t=new Z.Z({geometry:new w.Z([n.location.lng,n.location.lat]),id:n.id,dType:n.dType});e.getSource().addFeature(t)}}const U={name:"MapContainer",components:{IonButton:a.YG,IonIcon:a.gu},data(){const e=new y.Z({layers:[new g.Z({source:new f.Z})]});let t=null;return this.$route.query.type&&this.$route.query.id&&(t=D.Z.getDiscovery(parseInt(this.$route.query.id),this.$route.query.type),setTimeout((()=>this.focusDiscovery(t)),250)),{mainMap:null,INITAL_COORD:t?[t.location.lng,t.location.lat]:B.m.getLocation(),DEFAULT_ZOOM_LEVEL:t?17:14,TILE_LAYER:e,arrowRightIcon:m.kVA,settingsIcon:m.Fbs,locationIcon:z}},created(){this.$watch((()=>this.$route.params),(()=>{if(this.$route.query.type&&this.$route.query.id){const e=D.Z.getDiscovery(parseInt(this.$route.query.id),this.$route.query.type);this.focusDiscovery(e)}})),this.renderMap()},mounted(){this.myMap()},methods:{myMap(){(0,A.eL)(),this.mainMap=new d.Z({controls:(0,E.c)({attribution:!1}),target:"map",view:new h.ZP({center:this.INITAL_COORD,zoom:this.DEFAULT_ZOOM_LEVEL,enableRotation:!1}),layers:[this.TILE_LAYER]}),this.mainMap.on("singleclick",this.handleMapClick),this.mainMap.on("movestart",this.unfocusDiscovery),this.showPins(),this.showLocation()},renderMap(){this.myMap();const e=(0,G.yj)(),t=e.params.dType,n=e.params.id;if(t&&n){const e=D.Z.getDiscovery(parseInt(n.toString()),t.toString());this.focusDiscovery(e)}},showPins(e=[]){const t=new T.Z({source:new C.Z,style:D.Z.pinStyleFunction});e.length>0?W(t,e):W(t,B.m.getSortedDiscoveriesAZ()),this.mainMap.addLayer(t)},showLocation(){const e=new T.Z({source:new C.Z,style:new k.ZP({image:new O.Z({anchor:[.5,.5],src:n(8721)})})}),t=new Z.Z({geometry:new w.Z(B.m.getLocation())});e.getSource().addFeature(t),this.mainMap.addLayer(e),setInterval((()=>t.getGeometry().setCoordinates(B.m.getLocation())),5e3)},changeTileLayer(){const e=this.mainMap.getLayers();while(e.getLength()>0)this.mainMap.removeLayer(e.pop());if("osm"===B.m.getMapStyle()){const e=new y.Z({layers:[new g.Z({source:new M({layer:"toner-lite"})})]});this.mainMap.setLayerGroup(e),B.m.setMapStyle("stamen")}else{const e=new y.Z({layers:[new g.Z({source:new f.Z})]});this.mainMap.setLayerGroup(e),B.m.setMapStyle("osm")}this.showPins(),this.showLocation()},handleMapClick(e){const t=this.mainMap.getFeaturesAtPixel(e.pixel,{hitTolerance:10});if(t.length>0){const e=t[0].get("dType"),n=t[0].get("id"),o=D.Z.getDiscovery(n,e);S&&this.unfocusDiscovery(),this.focusDiscovery(o),S=!0}else S&&(this.unfocusDiscovery(),S=!1)},focusDiscovery(e,t=this.mainMap){if(!e)return;const n=200,o=t.getView().getCenter();if(o[0]!==e.location.lng||o[1]!==e.location.lat){const o=t.getView().getZoom();t.getView().animate({center:[e.location.lng,e.location.lat],duration:n,zoom:Math.max(o,14.25),easing:q.Vv})}const i=document.getElementById("popup-content");setTimeout((()=>{const e=document.getElementById("popup");e.classList.add("activated")}),n),setTimeout((()=>{const t=e.getTitle(),n="artwork"===e.dType?e.getArtists():e.getUsages();let o;o="artwork"===e.dType?0:"place"===e.dType?1:2;const a=document.getElementById("seeMore");a.onclick=()=>this.$router.push({path:`/discovery-details/${o}/${e.id}`}),document.getElementById("popupTitle").innerHTML=t,document.getElementById("popupSubtext").innerHTML=n.length>0?n:"Inconnu",i.hidden=!1}),n+100)},unfocusDiscovery(){const e=document.getElementById("popup-content"),t=document.getElementById("popup");e.hidden=!0,t.classList.remove("activated")},recenterView(){const e=this.mainMap.getView();e.animate({center:B.m.getLocation(),duration:200,zoom:Math.max(e.getZoom(),14.25),easing:q.Vv})}}};var _=n(3744);const N=(0,_.Z)(U,[["render",p],["__scopeId","data-v-483f4aac"]]),R=N,j={name:"MapPage",components:{IonHeader:a.Gu,IonContent:a.W2,IonPage:a._i,IonToolbar:a.sr,IonTitle:a.wd,MapContainer:R}},V=(0,_.Z)(j,[["render",i]]),F=V},8721:e=>{e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB8AAAAfCAYAAAAfrhY5AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAL0SURBVHgBtVc9bxNBEH27Zzuyk5NAICIiIVERCbrwB2iQQLIQDQhKhJJ0FPwBxA9IQ0eiFFRE0CELChoaylRUoaEAOQJRoDixydl3w5uzL4qDd88f8ZNO97G783Y+dmbOYEjc2ZRwP0GlaBAGAcpIMJONiUFTBHGU4E8lQaO2aprDyDR5E5Q0AhYsEGJI6GZabfz6tGp+Yxzy2y9kRmZxeRTSk0gSRKaFnQ9PzCGGJa++lPNxgEvGIMCEUHcUBfV3y+ZnLjnNvNChmXHKKIAbeGzqx7/ZPuINmZ8GsULl3qBFB5Krj9tmOsQZynSl8mTvhexByli0OT6mj8IEeCjAEl+uQBiMBg0eu6+814zFtkmw61xP+QmDmI87PXndAEsK6UcnlJSzl1NC9+7qHN+gOWs+WdR4h/5vpGaPi7jgm0xNV3h76iXuTlS3PWOEr/imRb24MtS6Qq2vuiZS46oKxIhgolkLBFuucdXeNq1bm6S7Q68WLhhqbzpu2ZqqbcnijEfGEq+LGA9hXMAD16DWCJuTxaqYBILrriEtTpbmqTgX63GaBL71rIrWu1jGLyo9eNf7yTWBTIaGn9zi0DkqzFwTQDzrtebbOEbLudpgGxOA8VTzbCy2bXGbJk0S45u+bjyb15bLzlk4+y1BWjQ2MA64juTOIqO9ntUEn3gCg5XuNbVfx2hYt9Zjcvpbm8w02ks0kUcQLCsVNXlOU+zCjwattUahXmtFAdKW6qiNurUpi3nNYhIz1xssiUWVCzWBhCkho1r9G3SwJYWcGOHpev/IfNHHo2YiDPFtfw/XfOnWBqmF9Oo3aU8FKQA5xJ3Z2W4j0X3t4e19EwUxvmOK+NvBrvJk7/91rzfZvRan0ES2abGPJ7rXgX27drHaTJ5G366mbkb4MejvxfnHcu+NlA4OsHj8n2xU6BHWWDpu6qHIM9x9JecOY8x7S+8AUoZ8/TNziG9eLnkG7fWiMuZsG2fVHX2b4fHRGiEl7B200cojzfAPzz4KXD6GoQAAAAAASUVORK5CYII="}}]);
//# sourceMappingURL=270-legacy.0adc5649.js.map