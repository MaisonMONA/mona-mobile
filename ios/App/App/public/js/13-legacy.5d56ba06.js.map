{"version":3,"file":"js/13-legacy.5d56ba06.js","mappings":"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","sources":["webpack://mona/./src/views/LoginPage.vue","webpack://mona/./src/views/LoginPage.vue?fce3"],"sourcesContent":["<template>\n    <ion-page>\n\n        <ion-header>\n            <ion-toolbar>\n                <ion-title>MONA</ion-title>\n            </ion-toolbar>\n        </ion-header>\n\n        <ion-content :fullscreen=\"true\">\n            <p id=\"login-alert-holder\"></p>\n            <div class=\"main-content\">\n                <p id=\"welcome\">Connexion</p>\n                <p id=\"ask-for-login\">Connectez-vous à votre compte.</p>\n\n                <div class=\"form-section\">\n                    <div class=\"input-element username\">\n                        <label for=\"login-username\">Nom d'utilisateur</label>\n                        <ion-item id=\"login-username\">\n                            <ion-input></ion-input>\n                        </ion-item>\n                    </div>\n\n                    <div class=\"input-element password\">\n                        <label for=\"login-password\">Mot de passe</label>\n                        <ion-item id=\"login-password\">\n                            <ion-input type=\"password\"></ion-input>\n                        </ion-item>\n                    </div>\n\n                    <ion-button @click=\"login\">Se connecter</ion-button>\n\n                    <p class=\"redirect-to-register\" @click=\"goToRegister\">Pas de compte ? <span>En créer un</span></p>\n                </div>\n            </div>\n        </ion-content>\n\n    </ion-page>\n</template>\n\n<script>\nimport { IonPage, IonHeader, IonToolbar, IonTitle, IonContent, IonItem, IonInput, IonButton } from \"@ionic/vue\";\nimport { UserData } from \"@/internal/databases/UserData\";\nimport Globals from \"@/internal/Globals\";\n\n\nexport default {\n    name: \"LoginPage\",\n    components: {\n        IonPage, IonHeader, IonToolbar, IonTitle, IonContent, IonItem, IonInput, IonButton\n    },\n\n    beforeMount() {\n        UserData.populate()\n        .then(() => {\n            if (UserData.getToken() !== '') {  // User is logged in, redirect\n                this.$router.replace(\"/loading\");\n            }\n        })\n    },\n\n    methods: {\n        goToRegister() {\n            this.$router.push(\"/register\");\n        },\n\n        login() {\n            const username = document.querySelector(\"ion-item#login-username ion-input\").value;\n            const password = document.querySelector(\"ion-item#login-password ion-input\").value;\n\n            if (username && password) {\n                const formData = new FormData();\n                formData.append(\"username\", username.trim());\n                formData.append(\"password\", password);\n\n                fetch(Globals.apiRoutes.login, {\n                    method: \"POST\",\n                    body: formData\n                })\n\n                .then(async (response) => {\n                    const parsed = await response.json();\n\n                    if (response.ok) {\n                        if (!parsed.token) {\n                            this.showAlert(\"Server error\");\n                        }\n\n                        UserData.setToken(parsed.token)\n                        UserData.setUsername(username.trim());\n                        this.$router.replace(\"/loading\");\n                    } else {\n                        // Show appropriate error\n                        if (parsed.errors && parsed.errors.username) {\n                            console.log(parsed)\n                            this.showAlert(parsed.errors.username[0]);\n                        } else {\n                            this.showAlert(`Erreur serveur (code ${response.status})`);\n                        }\n                    }\n                })\n\n                .catch(() => {\n                    this.showAlert(\"Impossible de se connecter à internet.\");\n                });\n            }\n        },\n\n        showAlert(alertMessage) {\n            const alertElem = document.getElementById(\"login-alert-holder\");\n\n            alertElem.innerHTML = alertMessage;\n            alertElem.classList.add(\"show\");\n        }\n    }\n}\n</script>\n\n<style scoped>\n@import url(\"@/theme/TopToolbar.css\");\n\n.ion-page {\n    background: white;\n}\n\np, label {\n    font-family: 'Gotham Rounded Light', sans-serif;\n}\n\n#welcome {\n    font-size: 20px;\n    font-weight: 900;\n}\n\n.main-content {\n    font-size: 14px;\n    text-align: center;\n    position: relative;\n    top: 20%;\n    width: 100%;\n    height: 85%;\n}\n\ndiv.form-section {\n    position: relative;\n    width: 100%;\n    height: 80%;\n}\n\n.input-element {\n    width: 70%;\n    margin: 5% auto;\n}\n\n.input-element * {\n    text-align: center;\n}\n\nion-input {\n    font-size: 14px;\n}\n\nlabel {\n    display: block;\n    text-align: center;\n}\n\n.redirect-to-register span {\n    font-weight: bolder;\n    border-bottom: 1px solid black;\n}\n\n#login-alert-holder {\n    position: absolute;\n    text-align: center;\n    transform: translateX(-50%);\n    left: 50%;\n    top: 15%;\n\n    padding: 0.2em 0.4em;\n    border-radius: 4px;\n\n    font-weight: bolder;\n    color: white;\n    background: white;\n    font-size: 12px;\n\n    transition: all 0.3s linear;\n}\n\n#login-alert-holder.show {\n    color: darkred;\n    background: #E6B1B1;\n}\n</style>\n","import { render } from \"./LoginPage.vue?vue&type=template&id=6fbcbf17&scoped=true\"\nimport script from \"./LoginPage.vue?vue&type=script&lang=js\"\nexport * from \"./LoginPage.vue?vue&type=script&lang=js\"\n\nimport \"./LoginPage.vue?vue&type=style&index=0&id=6fbcbf17&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-6fbcbf17\"]])\n\nexport default __exports__"],"names":["_createElementVNode","id","class","for","_createBlock","_component_ion_page","_createVNode","_component_ion_header","_component_ion_toolbar","_component_ion_title","_component_ion_content","fullscreen","_hoisted_1","_hoisted_2","_hoisted_3","_hoisted_4","_hoisted_5","_hoisted_6","_hoisted_7","_component_ion_item","_component_ion_input","_hoisted_8","_hoisted_9","type","_component_ion_button","onClick","$options","login","_cache","args","goToRegister","_hoisted_10","name","components","IonPage","IonHeader","IonToolbar","IonTitle","IonContent","IonItem","IonInput","IonButton","beforeMount","UserData","populate","then","getToken","this","$router","replace","methods","push","username","document","querySelector","value","password","formData","FormData","append","trim","fetch","Globals","apiRoutes","method","body","async","parsed","response","json","ok","token","showAlert","setToken","setUsername","errors","console","log","status","catch","alertMessage","alertElem","getElementById","innerHTML","classList","add","__exports__","render"],"sourceRoot":""}