{"version":3,"file":"js/261-legacy.66fbfada.js","mappings":"sNAUaA,MAAM,e,UACPC,EAAAA,EAAAA,GAA4B,mBAAzB,eAAUA,EAAAA,EAAAA,GAAI,4BAAO,K,GAIvBD,MAAM,wB,GACFA,MAAM,a,GAEAA,MAAM,S,UACTC,EAAAA,EAAAA,GAAoC,QAA9BD,MAAM,kBAAgB,W,SACzBA,MAAM,gB,GACNA,MAAM,gB,4NApB3BE,EAAAA,EAAAA,IAoCWC,EAAA,M,kBAlCT,IAIa,EAJbC,EAAAA,EAAAA,IAIaC,EAAA,M,kBAHT,IAEc,EAFdD,EAAAA,EAAAA,IAEcE,EAAA,M,kBADV,IAA2B,EAA3BF,EAAAA,EAAAA,IAA2BG,EAAA,M,kBAAhB,IAAI,UAAJ,W,yBAInBH,EAAAA,EAAAA,IA2BcI,EAAA,CA3BAC,YAAY,GAAI,C,kBAC1B,IAGM,EAHNR,EAAAA,EAAAA,GAGM,MAHNS,EAGM,CAFFC,GACAP,EAAAA,EAAAA,IAAgEQ,EAAA,CAAtDC,GAAG,aAAcC,KAAMC,EAAAC,oB,oBAGrCf,EAAAA,EAAAA,GAiBM,MAjBNgB,EAiBM,EAhBFhB,EAAAA,EAAAA,GAeM,MAfNiB,EAeM,EAdFjB,EAAAA,EAAAA,GAKM,aAJFA,EAAAA,EAAAA,GAAgC,IAAhCkB,GAAgCC,EAAAA,EAAAA,IAAZC,EAAAC,OAAK,GACzBC,EAC8BF,EAAAG,UAAUC,OAAS,IAAH,WAA9CC,EAAAA,EAAAA,IAAuE,IAAvEC,GAAuEP,EAAAA,EAAAA,IAAhBC,EAAAG,WAAS,qBAChEvB,EAAAA,EAAAA,GAA2C,IAA3C2B,GAA2CR,EAAAA,EAAAA,IAAhBC,EAAAQ,WAAS,MAG5CzB,EAAAA,EAAAA,IAEa0B,EAAA,CAFDjB,GAAG,eAAekB,KAAK,UAAWC,QAAOC,EAAAC,a,mBACjD,IAAoC,EAApC9B,EAAAA,EAAAA,IAAoCQ,EAAA,CAAzBE,KAAMC,EAAAoB,QAAM,oB,qBAG3B/B,EAAAA,EAAAA,IAEa0B,EAAA,CAFDjB,GAAG,aAAakB,KAAK,UAAW,cAAW,sBAAwBV,EAAAe,QAAQf,EAAAgB,UAAUxB,KAAM,mBAAiB,W,mBACpH,IAAsD,EAAtDT,EAAAA,EAAAA,IAAsDQ,EAAA,CAA3CE,KAAMC,EAAAuB,0BAAwB,oB,6BAKjDrC,EAAAA,EAAAA,GAAkF,OAA7EY,GAAG,eAAgBmB,QAAKO,EAAA,KAAAA,EAAA,GAAAC,GAAEP,EAAAQ,YAAY,CAACpB,EAAAgB,UAAUK,IAAKrB,EAAAgB,UAAUM,Y,oRAmC7E,GACIC,KAAM,6BACNC,WAAY,CACRC,QAAO,KAAEC,UAAS,KAAEC,QAAO,KAAEC,UAAS,KAAEC,WAAU,KAAEC,WAAU,KAAEC,SAAQA,EAAAA,IAG5EC,QACI,MAAO,CACHlB,OAAQmB,EAAAA,IAAeC,IAAG,MAAEjB,yBAAwB,MAAEtB,mBAAkBA,EAEhF,EAEAwC,OAEI,MAAMC,EAAO,IAAIC,KACXC,EAAwB,IAAjBF,EAAKG,UAA8C,KAAvBH,EAAKI,WAAa,GAAaJ,EAAKK,cACvEC,EAAS,IAAIC,EAAAA,EAAIL,GAEjBvB,EAAO2B,EAAOE,YAAY,EAAG,GAEnC,IAAI5B,EACA6B,EAAI,EACR,GAEQ7B,EADAD,IAAS+B,EAAAA,GAAcC,QACXC,EAAAA,EAAgBC,cAAcX,EAAOO,GAC5C9B,IAAS+B,EAAAA,GAAcI,MAChBC,EAAAA,EAAcF,cAAcX,EAAOO,GAEnCO,EAAAA,EAAiBH,cAAcX,EAAOO,GAGtDA,UACKQ,EAAAA,EAASC,YAAYtC,EAAUxB,GAAIwB,EAAUuC,QAEtD,MAAO,CACHvC,YAAWD,OAAM+B,cAAa,KAC9B7C,MAAOe,EAAUwC,WACjBrD,UAAWY,IAAS+B,EAAAA,GAAcC,QAAU/B,EAAUyC,aAAezC,EAAU0C,YAC/ElD,UAAWO,IAAS+B,EAAAA,GAAcC,QAAU/B,EAAU2C,gBAAkB3C,EAAU4C,aAE1F,EAEAC,UACIC,KAAKC,OACT,EAEAC,QAAS,CACLD,QACI,MAAME,EAAgB,CAACH,KAAK9C,UAAUkD,SAAS7C,IAAKyC,KAAK9C,UAAUkD,SAAS5C,MAC5E6C,EAAAA,EAAAA,MACAL,KAAKM,QAAU,IAAIC,EAAAA,EAAI,CAEnBC,UAAUC,EAAAA,EAAAA,GAAgB,CAAEC,aAAa,EAAOC,MAAM,IAGtDC,cAAcC,EAAAA,EAAAA,GAAoB,CAC9BC,SAAS,EACTC,WAAW,EACXC,gBAAgB,EAChBC,iBAAiB,IAGrBC,OAAQ,eACRC,KAAM,IAAIC,EAAAA,GAAK,CACXC,OAAQlB,EACRQ,KAAM,GACNW,gBAAgB,MAIxBtB,KAAKM,QAAQiB,cAAc,IAAIC,EAAAA,EAAW,CACtCC,OAAQ,CAAE,IAAIC,EAAAA,EAAU,CAAEC,OAAQ,IAAIC,EAAAA,QAI1C,MAAMC,EAAW,IAAIC,EAAAA,EAAY,CAC7BH,OAAQ,IAAII,EAAAA,EACZC,MAAOC,EAAAA,EAAMC,mBAGX9D,EAAM,IAAI+D,EAAAA,EAAQ,CACpBC,SAAU,IAAIC,EAAAA,EAAM,CAACrC,KAAK9C,UAAUkD,SAAS7C,IAAKyC,KAAK9C,UAAUkD,SAAS5C,MAC1E9B,GAAIsE,KAAK9C,UAAUxB,GACnB+D,MAAOO,KAAK9C,UAAUuC,QAE1BoC,EAASS,YAAYC,WAAWnE,GAEhC4B,KAAKM,QAAQkC,SAASX,EAC1B,EAEAvE,cACI,MAAMmF,EAAkB,CACpBC,KAAM,aACNC,MAAO,CACH1F,KAAM+C,KAAK9C,UAAUuC,MACrB/D,GAAIsE,KAAK9C,UAAUxB,KAI3BsE,KAAK4C,QAAQC,KAAKJ,EACtB,EAEAK,oBACQvD,EAAAA,EAASC,YAAYQ,KAAK9C,UAAUxB,GAAIsE,KAAK9C,UAAUuC,cACjDO,KAAK+C,aAAa,oCAE5B,MAAMC,QAAYf,EAAAA,EAAMlF,cACxB,GAAW,MAAPiG,EAAa,OAEjB,MAAMC,QAAiBhB,EAAAA,EAAMiB,YAAYF,GACzCzD,EAAAA,EAAS4D,aAAanD,KAAK9C,UAAW,OAAS+F,EAAU,KAAM,MAC/D1D,EAAAA,EAAS6D,iBAAiBpD,KAAK9C,UAAUxB,GAAIsE,KAAK9C,UAAUuC,OAE5D,MAAM4D,EAAc,CAChBX,KAAM,qBACNC,MAAO,CACHjH,GAAIsE,KAAK9C,UAAUxB,GACnBuB,KAAM+C,KAAK9C,UAAUuC,QAI7BO,KAAK4C,QAAQC,KAAKQ,EACtB,EAEAP,mBAAmBQ,GACf,MAAMC,QAAcC,EAAAA,GAAgBC,OAAO,CACvCC,QAASJ,EACTK,SAAU,IACVC,QAAS,CAAC,CAAEN,KAAM,mBAGhBC,EAAMM,SAChB,I,cClMR,MAAMC,GAA2B,OAAgB,EAAQ,CAAC,CAAC,SAASC,GAAQ,CAAC,YAAY,qBAEzF,G","sources":["webpack://mona/./src/views/DiscoveryOfTheDayPage.vue","webpack://mona/./src/views/DiscoveryOfTheDayPage.vue?e824"],"sourcesContent":["<template>\n  <ion-page>\n\n    <ion-header>\n        <ion-toolbar>\n            <ion-title>MONA</ion-title>\n        </ion-toolbar>\n    </ion-header>\n\n    <ion-content :fullscreen=\"true\">\n        <div class=\"page-header\">\n            <p>Découverte<br>du jour</p>\n            <ion-icon id=\"headerIcon\" :icon=\"customCalendarIcon\"></ion-icon>\n        </div>\n\n        <div class=\"page-body-background\">\n            <div class=\"page-body\">\n                <div>\n                    <p class=\"title\">{{ title }}</p>\n                    <span class=\"separating-bar\"></span>\n                    <p class=\"subtitle one\" v-if=\"subtitle1.length > 0\">{{ subtitle1 }}</p>\n                    <p class=\"subtitle two\">{{ subtitle2 }}</p>\n                </div>\n\n            <ion-button id=\"cameraButton\" fill=\"outline\" @click=\"takePicture\">\n                <ion-icon :icon=\"camera\"></ion-icon>\n            </ion-button>\n\n            <ion-button id=\"infoButton\" fill=\"outline\" :router-link=\"`/discovery-details/${type}/${discovery.id}`\" router-direction=\"forward\">\n                <ion-icon :icon=\"informationCircleOutline\"></ion-icon>\n            </ion-button>\n            </div>\n        </div>\n\n        <div id=\"mapContainer\" @click=\"activateMap([discovery.lng, discovery.lat])\"></div>\n\n    </ion-content>\n  </ion-page>\n</template>\n\n<script>\n/* Vue/Ionic imports */\nimport { cameraOutline, informationCircleOutline, pin } from 'ionicons/icons';\nimport { IonPage, IonHeader, IonContent, IonToolbar, IonTitle, IonButton, IonIcon, toastController } from \"@ionic/vue\";\n\n/* Imports for the map */\nimport Map from \"ol/Map\";\nimport View from \"ol/View\";\nimport { defaults as defaultControls } from \"ol/control\";\nimport { defaults as defaultInteractions } from \"ol/interaction\";\nimport { useGeographic } from \"ol/proj\";\nimport { Group as layerGroup } from \"ol/layer\";\nimport TileLayer from \"ol/layer/Tile\";\nimport { OSM } from \"ol/source\";\nimport VectorLayer from \"ol/layer/Vector\";\nimport VectorSource from \"ol/source/Vector\";\nimport Feature from \"ol/Feature\";\nimport Point from \"ol/geom/Point\";\n\n/* Custom imports */\nimport { ArtworkDatabase } from \"@/internal/databases/ArtworkDatabase\";\nimport { PlaceDatabase } from \"@/internal/databases/PlaceDatabase\";\nimport { HeritageDatabase } from \"@/internal/databases/HeritageDatabase\";\nimport { RNG } from \"@/internal/RNG\"\nimport Utils from \"@/internal/Utils\";\nimport { DiscoveryEnum } from \"@/internal/Types\";\nimport { UserData } from \"@/internal/databases/UserData\";\nimport customCalendarIcon from \"@/assets/drawable/icons/calendar.svg\"\n\nexport default {\n    name: \"DiscoveryOfTheDayContainer\",\n    components: {\n        IonIcon, IonButton, IonPage, IonHeader, IonContent, IonToolbar, IonTitle,\n    },\n\n    setup() {\n        return {\n            camera: cameraOutline, pin, informationCircleOutline, customCalendarIcon\n        }\n    },\n\n    data() {\n        // Build seed as the integer represented by ddMMyyyy\n        const date = new Date();\n        const seed = date.getDate() * 1000000 + (date.getMonth() + 1) * 10000 + date.getFullYear();\n        const random = new RNG(seed);\n\n        const type = random.nextInRange(0, 2);  // Choose what type of discovery to show\n\n        let discovery;\n        let i = 0;\n        do {\n            if (type === DiscoveryEnum.ARTWORK)\n                discovery = ArtworkDatabase.getRandomItem(seed + i);\n            else if (type === DiscoveryEnum.PLACE)\n                discovery = PlaceDatabase.getRandomItem(seed + i);\n            else /* if (type === DiscoveryEnum.HERITAGE) */\n                discovery = HeritageDatabase.getRandomItem(seed + i);\n\n            // `i` is used to keep control of randomness when looking for an unknown discovery\n            i++;\n        } while (UserData.isCollected(discovery.id, discovery.dType));  // Make sure the discovery is not collected\n\n        return {\n            discovery, type, DiscoveryEnum,\n            title: discovery.getTitle(),\n            subtitle1: type === DiscoveryEnum.ARTWORK ? discovery.getArtists() : discovery.getUsages(),\n            subtitle2: type === DiscoveryEnum.ARTWORK ? discovery.getCategories() : discovery.getBorough()\n        }\n    },\n\n    mounted() {\n        this.myMap();\n    },\n\n    methods: {\n        myMap() {\n            const INITIAL_COORD = [this.discovery.location.lng, this.discovery.location.lat];\n            useGeographic();\n            this.mainMap = new Map({\n                // Hiding attribution (quite immoral isn't it?)\n                controls: defaultControls({ attribution: false, zoom: false }),\n\n                // Disabling interactions\n                interactions: defaultInteractions({\n                    dragPan: false,\n                    pinchZoom: false,\n                    mouseWheelZoom: false,\n                    doubleClickZoom: false\n                }),\n\n                target: \"mapContainer\",\n                view: new View({\n                    center: INITIAL_COORD,\n                    zoom: 17,\n                    enableRotation: false,\n                }),\n            });\n\n            this.mainMap.setLayerGroup(new layerGroup({\n                layers: [ new TileLayer({ source: new OSM() }) ]\n            }));\n\n            // Showing the pin\n            const pinLayer = new VectorLayer({\n                source: new VectorSource(),\n                style: Utils.pinStyleFunction\n            })\n\n            const pin = new Feature({\n                geometry: new Point([this.discovery.location.lng, this.discovery.location.lat]),\n                id: this.discovery.id,\n                dType: this.discovery.dType\n            });\n            pinLayer.getSource().addFeature(pin);\n\n            this.mainMap.addLayer(pinLayer);\n        },\n\n        activateMap() {\n            const mapInstructions = {\n                path: \"/tabs/map/\",\n                query: {\n                    type: this.discovery.dType,\n                    id: this.discovery.id\n                }\n            };\n\n            this.$router.push(mapInstructions);\n        },\n\n        async takePicture() {\n            if (UserData.isCollected(this.discovery.id, this.discovery.dType))\n                await this.presentToast(\"Nous avez déjà collectionné cela\");\n\n            const img = await Utils.takePicture();\n            if (img == null) return;\n\n            const filename = await Utils.savePicture(img);\n            UserData.addCollected(this.discovery, \"img/\" + filename, null, null);\n            UserData.addPendingUpload(this.discovery.id, this.discovery.dType);\n\n            const redirection = {\n                path: \"/discovery-review/\",\n                query: {\n                    id: this.discovery.id,\n                    type: this.discovery.dType,\n                }\n            };\n\n            this.$router.push(redirection);\n        },\n\n        async presentToast(text) {\n            const toast = await toastController.create({\n                message: text,\n                duration: 3000,\n                buttons: [{ text: \"Fermer\" }]\n            });\n\n            await toast.present();\n        },\n    }\n}\n</script>\n\n<style scoped>\n@import url(\"@/theme/GlobalStyle.css\");\n@import url(\"ol/ol.css\");\n\n* {\n    font-family: 'OpenSans', sans-serif;\n    box-sizing: content-box;\n}\n\nion-button ion-icon {\n    font-weight: 100;\n    font-size: 50px;\n    --ionicon-stroke-width: 20;\n}\n\nion-button {\n    --border-radius: 15px;\n}\n\n.title {\n    font-size: 6vw;\n    font-weight: 600;\n}\n\nspan.separating-bar {\n    margin-top: 2vw;\n    margin-bottom: 2vw;\n    display: block;\n    width: 20vw;\n    border-bottom: 4px solid var(--blue-powder);\n}\n\n.subtitle.one {\n    font-size: 5vw;\n    font-weight: 400;\n}\n\n.subtitle.two {\n    margin-top: 2vw;\n    font-size: 4vw;\n}\n\ndiv, p {\n    margin: 0;\n    padding: 0;\n}\n\n.page-header {\n    position: relative;\n    height: 25%;\n    background: var(--blue-powder);\n}\n\n.page-body-background {\n    height: 70%;\n    background: var(--blue-powder);\n    border: 0;\n}\n\n.page-body {\n    height: 100%;\n    background: white;\n    border-radius: 25px 25px 0 0;\n    padding: 5%;\n    border: 0;\n}\n\n#headerIcon {\n    position: absolute;\n    transform: translate(-50%, -50%);\n    left: 25%;\n    top: 50%;\n    color: white;\n    font-size: 80px;\n    --ionicon-stroke-width: 20;\n}\n\n.page-header p {\n    margin: 0;\n    position: absolute;\n    transform: translate(-50%, -50%);\n    left: 60%;\n    top: 50%;\n    color: white;\n    font-size: 28px;\n    font-weight: 600;\n}\n\n#mapContainer {\n    position: absolute;\n    bottom: 12.5%;\n    left: 5%;\n    width: 90%;\n    height: 15%;\n    overflow: hidden;\n    border-radius: 20px;\n    border: 1px solid var(--button-outline-grey);\n}\n\n#cameraButton, #infoButton {\n    position: absolute;\n    justify-content: center;\n    bottom: 30%;\n    height: 15%;\n    --border-color: var(--button-outline-grey);\n    --border-width: 1px;\n    --background: white;\n    --background-activated: white;\n    color: black;\n    width: 42%;\n    transition: color 0.2s cubic-bezier(.3, .9, .9, .9), --border-color 0.2s cubic-bezier(.3, .9, .9, .9);\n}\n\n#cameraButton:active {\n    color: var(--button-activated);\n}\n\n#infoButton:active {\n    color: var(--button-activated);\n}\n\n#cameraButton {\n    left: 5%;\n}\n\n#infoButton {\n    right: 5%;\n}\n\nion-header {\n    margin: 0;\n    padding: 0;\n}\n</style>\n","import { render } from \"./DiscoveryOfTheDayPage.vue?vue&type=template&id=74c6a08a&scoped=true\"\nimport script from \"./DiscoveryOfTheDayPage.vue?vue&type=script&lang=js\"\nexport * from \"./DiscoveryOfTheDayPage.vue?vue&type=script&lang=js\"\n\nimport \"./DiscoveryOfTheDayPage.vue?vue&type=style&index=0&id=74c6a08a&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-74c6a08a\"]])\n\nexport default __exports__"],"names":["class","_createElementVNode","_createBlock","_component_ion_page","_createVNode","_component_ion_header","_component_ion_toolbar","_component_ion_title","_component_ion_content","fullscreen","_hoisted_1","_hoisted_2","_component_ion_icon","id","icon","$setup","customCalendarIcon","_hoisted_3","_hoisted_4","_hoisted_5","_toDisplayString","$data","title","_hoisted_6","subtitle1","length","_createElementBlock","_hoisted_7","_hoisted_8","subtitle2","_component_ion_button","fill","onClick","$options","takePicture","camera","type","discovery","informationCircleOutline","_cache","$event","activateMap","lng","lat","name","components","IonIcon","IonButton","IonPage","IonHeader","IonContent","IonToolbar","IonTitle","setup","cameraOutline","pin","data","date","Date","seed","getDate","getMonth","getFullYear","random","RNG","nextInRange","i","DiscoveryEnum","ARTWORK","ArtworkDatabase","getRandomItem","PLACE","PlaceDatabase","HeritageDatabase","UserData","isCollected","dType","getTitle","getArtists","getUsages","getCategories","getBorough","mounted","this","myMap","methods","INITIAL_COORD","location","useGeographic","mainMap","Map","controls","defaultControls","attribution","zoom","interactions","defaultInteractions","dragPan","pinchZoom","mouseWheelZoom","doubleClickZoom","target","view","View","center","enableRotation","setLayerGroup","layerGroup","layers","TileLayer","source","OSM","pinLayer","VectorLayer","VectorSource","style","Utils","pinStyleFunction","Feature","geometry","Point","getSource","addFeature","addLayer","mapInstructions","path","query","$router","push","async","presentToast","img","filename","savePicture","addCollected","addPendingUpload","redirection","text","toast","toastController","create","message","duration","buttons","present","__exports__","render"],"sourceRoot":""}